<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Packet Sniffer - Network Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Packet Sniffer</h1>
            <p>Network Traffic Analyzer & Monitor - H·ªó tr·ª£ IPv4, IPv6, FTP, SMTP, POP3, IMAP, HTTP</p>
        </div>

        <div class="control-panel">
            <div class="form-grid">
                <div class="form-group">
                    <label for="protocol">Protocol</label>
                    <select id="protocol">
                        <option value="">T·∫•t c·∫£</option>
                        <option value="tcp">TCP</option>
                        <option value="udp">UDP</option>
                        <option value="icmp">ICMP</option>
                        <option value="arp">ARP</option>
                        <option value="ipv6">IPv6</option>
                        <option value="dns">DNS</option>
                        <option value="ftp">FTP</option>
                        <option value="smtp">SMTP</option>
                        <option value="pop3">POP3</option>
                        <option value="imap">IMAP</option>
                        <option value="http">HTTP</option>
                        <option value="https">HTTPS</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="ip">IP Address (IPv4/IPv6)</label>
                    <input type="text" id="ip" placeholder="8.8.8.8 ho·∫∑c 2001:4860:4860::8888">
                </div>

                <div class="form-group">
                    <label for="domain">Domain</label>
                    <input type="text" id="domain" placeholder="google.com">
                </div>

                <div class="form-group">
                    <label for="port">Port</label>
                    <input type="number" id="port" placeholder="80, 443, 53...">
                </div>

                <div class="form-group">
                    <label for="max_packets">Max Packets</label>
                    <input type="number" id="max_packets" placeholder="Kh√¥ng gi·ªõi h·∫°n">
                </div>

                <div class="form-group">
                    <label for="interface">Interface</label>
                    <input type="text" id="interface" placeholder="eth0, wlan0...">
                </div>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="ping_reply_only">
                <label for="ping_reply_only">Ch·ªâ b·∫Øt Ping Reply (ICMP Echo Reply)</label>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="detect_security">
                <label for="detect_security">üîí Ph√°t hi·ªán t·∫•n c√¥ng (Port Scan, SYN Flood, ARP Spoofing)</label>
            </div>

            <div class="button-group">
                <button class="btn btn-start" id="startBtn" onclick="startCapture()">
                    ‚ñ∂ B·∫Øt ƒë·∫ßu b·∫Øt g√≥i tin
                </button>
                <button class="btn btn-stop" id="stopBtn" onclick="stopCapture()" disabled>
                    ‚èπ D·ª´ng
                </button>
                <button class="btn btn-clear" onclick="clearPackets()">
                    üóë X√≥a
                </button>
            </div>
        </div>

        <div class="alert" id="alert"></div>

        <div id="filterInfo" class="filter-info" style="display: none;">
            <strong>üîç ƒêang l·ªçc:</strong> <span id="filterDetails"></span>
        </div>

        <div class="status-bar">
            <div class="status-indicator">
                <div class="status-dot" id="statusDot"></div>
                <span id="statusText">Ch∆∞a b·∫Øt ƒë·∫ßu</span>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalPackets">0</div>
                    <div class="stat-label">T·ªïng g√≥i tin</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="packetsPerSec">0</div>
                    <div class="stat-label">G√≥i/gi√¢y</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="tcpCount">0</div>
                    <div class="stat-label">TCP</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="udpCount">0</div>
                    <div class="stat-label">UDP</div>
                </div>
            </div>
        </div>

        <div class="packets-container">
            <table class="packets-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Time</th>
                        <th>Protocol</th>
                        <th>Source</th>
                        <th>Destination</th>
                        <th>Length</th>
                        <th>Info</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="packetsBody">
                    <tr>
                        <td colspan="8" class="no-packets">
                            Ch∆∞a c√≥ g√≥i tin n√†o. Nh·∫•n "B·∫Øt ƒë·∫ßu b·∫Øt g√≥i tin" ƒë·ªÉ b·∫Øt ƒë·∫ßu.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- User Guide Section -->
        <div class="user-guide-section">
            <div class="guide-header" onclick="toggleGuide()">
                <h2>üìñ H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng</h2>
                <span class="toggle-icon" id="toggleIcon">‚ñº</span>
            </div>
            <div class="guide-content" id="guideContent">
                <div class="guide-grid">
                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">üöÄ</span>
                            <h3>B·∫Øt ƒê·∫ßu Nhanh</h3>
                        </div>
                        <ol class="guide-list">
                            <li>Ch·∫°y ·ª©ng d·ª•ng v·ªõi quy·ªÅn root: <code>sudo python3 d.py</code></li>
                            <li>M·ªü tr√¨nh duy·ªát t·∫°i <code>http://localhost:5000</code></li>
                            <li>Nh·∫•n n√∫t <strong>"‚ñ∂ B·∫Øt ƒë·∫ßu b·∫Øt g√≥i tin"</strong></li>
                            <li>Quan s√°t c√°c g√≥i tin xu·∫•t hi·ªán trong b·∫£ng</li>
                            <li>Click <strong>"üìã Chi ti·∫øt"</strong> ƒë·ªÉ xem ph√¢n t√≠ch OSI 7 t·∫ßng</li>
                        </ol>
                    </div>

                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">üîç</span>
                            <h3>B·ªô L·ªçc C∆° B·∫£n</h3>
                        </div>
                        <ul class="guide-list">
                            <li><strong>Protocol:</strong> L·ªçc theo giao th·ª©c (TCP, UDP, HTTP, FTP, DNS...)</li>
                            <li><strong>IP Address:</strong> L·ªçc theo ƒë·ªãa ch·ªâ IPv4 ho·∫∑c IPv6
                                <div class="guide-example">VD: <code>8.8.8.8</code> ho·∫∑c <code>2001:4860:4860::8888</code></div>
                            </li>
                            <li><strong>Domain:</strong> T·ª± ƒë·ªông resolve sang IP (h·ªó tr·ª£ IPv4 & IPv6)
                                <div class="guide-example">VD: <code>google.com</code>, <code>facebook.com</code></div>
                            </li>
                            <li><strong>Port:</strong> L·ªçc theo c·ªïng d·ªãch v·ª•
                                <div class="guide-example">VD: <code>80</code> (HTTP), <code>443</code> (HTTPS), <code>21</code> (FTP)</div>
                            </li>
                        </ul>
                    </div>

                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">üéØ</span>
                            <h3>V√≠ D·ª• Th·ª±c T·∫ø</h3>
                        </div>
                        <div class="example-list">
                            <div class="example-item">
                                <strong>üåê B·∫Øt traffic HTTP:</strong>
                                <div class="example-config">
                                    Protocol: <code>HTTP</code> | Port: <code>80</code>
                                </div>
                                <div class="example-desc">Sau ƒë√≥ truy c·∫≠p <code>http://example.com</code></div>
                            </div>
                            <div class="example-item">
                                <strong>üìß B·∫Øt email SMTP:</strong>
                                <div class="example-config">
                                    Protocol: <code>SMTP</code> | Port: <code>25</code>
                                </div>
                            </div>
                            <div class="example-item">
                                <strong>üåç B·∫Øt traffic IPv6:</strong>
                                <div class="example-config">
                                    Protocol: <code>IPv6</code> | Domain: <code>ipv6.google.com</code>
                                </div>
                            </div>
                            <div class="example-item">
                                <strong>üîç B·∫Øt DNS queries:</strong>
                                <div class="example-config">
                                    Protocol: <code>DNS</code> | Port: <code>53</code>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">üîê</span>
                            <h3>T√≠nh NƒÉng B·∫£o M·∫≠t</h3>
                        </div>
                        <ul class="guide-list">
                            <li><strong>Port Scan Detection:</strong> Ph√°t hi·ªán khi c√≥ ng∆∞·ªùi scan port</li>
                            <li><strong>SYN Flood Detection:</strong> Ph√°t hi·ªán t·∫•n c√¥ng t·ª´ ch·ªëi d·ªãch v·ª•</li>
                            <li><strong>ARP Spoofing Detection:</strong> Ph√°t hi·ªán t·∫•n c√¥ng gi·∫£ m·∫°o ARP</li>
                        </ul>
                        <div class="guide-note">
                            üí° <strong>Tip:</strong> B·∫≠t checkbox "üîí Ph√°t hi·ªán t·∫•n c√¥ng" ƒë·ªÉ k√≠ch ho·∫°t
                        </div>
                    </div>

                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">üìä</span>
                            <h3>Ph√¢n T√≠ch OSI 7 T·∫ßng</h3>
                        </div>
                        <div class="osi-layers-info">
                            <div class="osi-layer-item">
                                <span class="layer-badge">1</span>
                                <span><strong>Physical Layer:</strong> Th√¥ng tin v·∫≠t l√Ω, k√≠ch th∆∞·ªõc frame</span>
                            </div>
                            <div class="osi-layer-item">
                                <span class="layer-badge">2</span>
                                <span><strong>Data Link:</strong> ƒê·ªãa ch·ªâ MAC, Ethernet/ARP</span>
                            </div>
                            <div class="osi-layer-item">
                                <span class="layer-badge">3</span>
                                <span><strong>Network:</strong> ƒê·ªãa ch·ªâ IP, TTL, routing</span>
                            </div>
                            <div class="osi-layer-item">
                                <span class="layer-badge">4</span>
                                <span><strong>Transport:</strong> TCP/UDP, port, flags, seq/ack</span>
                            </div>
                            <div class="osi-layer-item">
                                <span class="layer-badge">5</span>
                                <span><strong>Session:</strong> Qu·∫£n l√Ω phi√™n k·∫øt n·ªëi</span>
                            </div>
                            <div class="osi-layer-item">
                                <span class="layer-badge">6</span>
                                <span><strong>Presentation:</strong> M√£ h√≥a, n√©n d·ªØ li·ªáu</span>
                            </div>
                            <div class="osi-layer-item">
                                <span class="layer-badge">7</span>
                                <span><strong>Application:</strong> HTTP, FTP, SMTP, DNS...</span>
                            </div>
                        </div>
                    </div>

                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">‚öôÔ∏è</span>
                            <h3>C·∫•u H√¨nh N√¢ng Cao</h3>
                        </div>
                        <ul class="guide-list">
                            <li><strong>Interface:</strong> Ch·ªâ ƒë·ªãnh card m·∫°ng c·ª• th·ªÉ
                                <div class="guide-example">VD: <code>eth0</code>, <code>wlan0</code>, <code>enp0s3</code></div>
                            </li>
                            <li><strong>Max Packets:</strong> Gi·ªõi h·∫°n s·ªë g√≥i tin b·∫Øt</li>
                            <li><strong>Ping Reply Only:</strong> Ch·ªâ b·∫Øt ICMP Echo Reply (response c·ªßa ping)</li>
                        </ul>
                        <div class="guide-note">
                            üí° <strong>Tip:</strong> ƒê·ªÉ tr·ªëng ƒë·ªÉ b·∫Øt t·∫•t c·∫£ g√≥i tin tr√™n t·∫•t c·∫£ interface
                        </div>
                    </div>

                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">üéì</span>
                            <h3>C√°c Port Th√¥ng D·ª•ng</h3>
                        </div>
                        <div class="port-table">
                            <div class="port-row">
                                <span class="port-num">21</span>
                                <span class="port-name">FTP</span>
                                <span class="port-desc">File Transfer Protocol</span>
                            </div>
                            <div class="port-row">
                                <span class="port-num">22</span>
                                <span class="port-name">SSH</span>
                                <span class="port-desc">Secure Shell</span>
                            </div>
                            <div class="port-row">
                                <span class="port-num">25</span>
                                <span class="port-name">SMTP</span>
                                <span class="port-desc">Email g·ª≠i ƒëi</span>
                            </div>
                            <div class="port-row">
                                <span class="port-num">53</span>
                                <span class="port-name">DNS</span>
                                <span class="port-desc">Domain Name System</span>
                            </div>
                            <div class="port-row">
                                <span class="port-num">80</span>
                                <span class="port-name">HTTP</span>
                                <span class="port-desc">Web kh√¥ng m√£ h√≥a</span>
                            </div>
                            <div class="port-row">
                                <span class="port-num">110</span>
                                <span class="port-name">POP3</span>
                                <span class="port-desc">Email nh·∫≠n v·ªÅ</span>
                            </div>
                            <div class="port-row">
                                <span class="port-num">143</span>
                                <span class="port-name">IMAP</span>
                                <span class="port-desc">Email ƒë·ªìng b·ªô</span>
                            </div>
                            <div class="port-row">
                                <span class="port-num">443</span>
                                <span class="port-name">HTTPS</span>
                                <span class="port-desc">Web c√≥ m√£ h√≥a SSL/TLS</span>
                            </div>
                        </div>
                    </div>

                    <div class="guide-card">
                        <div class="guide-card-header">
                            <span class="guide-icon">‚ö†Ô∏è</span>
                            <h3>L∆∞u √ù Quan Tr·ªçng</h3>
                        </div>
                        <ul class="guide-list warning-list">
                            <li>üîê <strong>Quy·ªÅn Root:</strong> Ph·∫£i ch·∫°y v·ªõi <code>sudo</code> ƒë·ªÉ b·∫Øt ƒë∆∞·ª£c g√≥i tin</li>
                            <li>üö´ <strong>ƒê·∫°o ƒê·ª©c:</strong> Ch·ªâ s·ª≠ d·ª•ng tr√™n m·∫°ng c·ªßa b·∫°n ho·∫∑c c√≥ s·ª± cho ph√©p</li>
                            <li>‚ö° <strong>Hi·ªáu NƒÉng:</strong> B·∫Øt nhi·ªÅu g√≥i tin c√≥ th·ªÉ l√†m ch·∫≠m h·ªá th·ªëng</li>
                            <li>üîí <strong>B·∫£o M·∫≠t:</strong> Kh√¥ng b·∫Øt g√≥i tin tr√™n m·∫°ng c√¥ng c·ªông kh√¥ng r√µ ngu·ªìn g·ªëc</li>
                            <li>üíæ <strong>B·ªô Nh·ªõ:</strong> N√™n ƒë·∫∑t gi·ªõi h·∫°n Max Packets khi b·∫Øt l√¢u d√†i</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>üî¨ Packet Sniffer - Network Analysis Tool | H·ªó tr·ª£ IPv4, IPv6, HTTP, FTP, SMTP, POP3, IMAP, DNS</p>
            <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                üí° S·ª≠ d·ª•ng c√≥ tr√°ch nhi·ªám - Ch·ªâ ph√¢n t√≠ch m·∫°ng c·ªßa b·∫°n ho·∫∑c c√≥ s·ª± cho ph√©p
            </p>
        </div>
    </div>

    <!-- Modal Chi Ti·∫øt Packet -->
    <div id="packetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üì¶ Chi Ti·∫øt G√≥i Tin - OSI 7 T·∫ßng</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <div class="loading"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        function toggleGuide() {
            const content = document.getElementById('guideContent');
            const icon = document.getElementById('toggleIcon');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.textContent = '‚ñº';
            } else {
                content.style.display = 'none';
                icon.textContent = '‚ñ∂';
            }
        }
    </script>
</body>
</html>